(()=>{var O=Object.defineProperty,Z=Object.prototype.hasOwnProperty;var P=(r,e)=>()=>(e||(e={exports:{}},r(e.exports,e)),e.exports),X=r=>O(r,"__esModule",{value:!0});var Y=(r,e)=>{if(X(r),typeof e=="object"||typeof e=="function")for(let a in e)!Z.call(r,a)&&a!=="default"&&O(r,a,{get:()=>e[a],enumerable:!0});return r},rr=r=>r&&r.__esModule?r:Y(O({},"default",{value:r,enumerable:!0}),r);var j=P(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var V=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"];I.decode83=function(r){for(var e=0,a=0;a<r.length;a++){var t=r[a],s=V.indexOf(t);e=e*83+s}return e};I.encode83=function(r,e){for(var a="",t=1;t<=e;t++){var s=Math.floor(r)/Math.pow(83,e-t)%83;a+=V[Math.floor(s)]}return a}});var x=P(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.sRGBToLinear=function(r){var e=r/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)};B.linearTosRGB=function(r){var e=Math.max(0,Math.min(1,r));return e<=.0031308?Math.round(e*12.92*255+.5):Math.round((1.055*Math.pow(e,1/2.4)-.055)*255+.5)};B.sign=function(r){return r<0?-1:1};B.signPow=function(r,e){return B.sign(r)*Math.pow(Math.abs(r),e)}});var C=P(A=>{"use strict";var er=A&&A.__extends||function(){var r=function(e,a){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},r(e,a)};return function(e,a){r(e,a);function t(){this.constructor=e}e.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)}}();Object.defineProperty(A,"__esModule",{value:!0});var ar=function(r){er(e,r);function e(a){var t=r.call(this,a)||this;return t.name="ValidationError",t.message=a,t}return e}(Error);A.ValidationError=ar});var F=P(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});var E=j(),y=x(),k=C(),z=function(r){if(!r||r.length<6)throw new k.ValidationError("The blurhash string must be at least 6 characters");var e=E.decode83(r[0]),a=Math.floor(e/9)+1,t=e%9+1;if(r.length!==4+2*t*a)throw new k.ValidationError("blurhash length mismatch: length is "+r.length+" but it should be "+(4+2*t*a))};G.isBlurhashValid=function(r){try{z(r)}catch(e){return{result:!1,errorReason:e.message}}return{result:!0}};var tr=function(r){var e=r>>16,a=r>>8&255,t=r&255;return[y.sRGBToLinear(e),y.sRGBToLinear(a),y.sRGBToLinear(t)]},or=function(r,e){var a=Math.floor(r/(19*19)),t=Math.floor(r/19)%19,s=r%19,i=[y.signPow((a-9)/9,2)*e,y.signPow((t-9)/9,2)*e,y.signPow((s-9)/9,2)*e];return i},nr=function(r,e,a,t){z(r),t=t|1;for(var s=E.decode83(r[0]),i=Math.floor(s/9)+1,d=s%9+1,f=E.decode83(r[1]),v=(f+1)/166,o=new Array(d*i),n=0;n<o.length;n++)if(n===0){var l=E.decode83(r.substring(2,6));o[n]=tr(l)}else{var l=E.decode83(r.substring(4+n*2,6+n*2));o[n]=or(l,v*t)}for(var u=e*4,g=new Uint8ClampedArray(u*a),h=0;h<a;h++)for(var c=0;c<e;c++){for(var b=0,w=0,m=0,_=0;_<i;_++)for(var n=0;n<d;n++){var p=Math.cos(Math.PI*c*n/e)*Math.cos(Math.PI*h*_/a),M=o[n+_*d];b+=M[0]*p,w+=M[1]*p,m+=M[2]*p}var q=y.linearTosRGB(b),K=y.linearTosRGB(w),Q=y.linearTosRGB(m);g[4*c+0+h*u]=q,g[4*c+1+h*u]=K,g[4*c+2+h*u]=Q,g[4*c+3+h*u]=255}return g};G.default=nr});var H=P(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var T=j(),R=x(),S=C(),U=4,sr=function(r,e,a,t){for(var s=0,i=0,d=0,f=e*U,v=0;v<e;v++)for(var o=0;o<a;o++){var n=t(v,o);s+=n*R.sRGBToLinear(r[U*v+0+o*f]),i+=n*R.sRGBToLinear(r[U*v+1+o*f]),d+=n*R.sRGBToLinear(r[U*v+2+o*f])}var l=1/(e*a);return[s*l,i*l,d*l]},ir=function(r){var e=R.linearTosRGB(r[0]),a=R.linearTosRGB(r[1]),t=R.linearTosRGB(r[2]);return(e<<16)+(a<<8)+t},lr=function(r,e){var a=Math.floor(Math.max(0,Math.min(18,Math.floor(R.signPow(r[0]/e,.5)*9+9.5)))),t=Math.floor(Math.max(0,Math.min(18,Math.floor(R.signPow(r[1]/e,.5)*9+9.5)))),s=Math.floor(Math.max(0,Math.min(18,Math.floor(R.signPow(r[2]/e,.5)*9+9.5))));return a*19*19+t*19+s},cr=function(r,e,a,t,s){if(t<1||t>9||s<1||s>9)throw new S.ValidationError("BlurHash must have between 1 and 9 components");if(e*a*4!==r.length)throw new S.ValidationError("Width and height must match the pixels array");for(var i=[],d=function(c){for(var b=function(m){var _=m==0&&c==0?1:2,p=sr(r,e,a,function(M,q){return _*Math.cos(Math.PI*m*M/e)*Math.cos(Math.PI*c*q/a)});i.push(p)},w=0;w<t;w++)b(w)},f=0;f<s;f++)d(f);var v=i[0],o=i.slice(1),n="",l=t-1+(s-1)*9;n+=T.encode83(l,1);var u;if(o.length>0){var g=Math.max.apply(Math,o.map(function(c){return Math.max.apply(Math,c)})),h=Math.floor(Math.max(0,Math.min(82,Math.floor(g*166-.5))));u=(h+1)/166,n+=T.encode83(h,1)}else u=1,n+=T.encode83(0,1);return n+=T.encode83(ir(v),4),o.forEach(function(c){n+=T.encode83(lr(c,u),2)}),n};D.default=cr});var N=P(L=>{"use strict";function ur(r){for(var e in r)L.hasOwnProperty(e)||(L[e]=r[e])}Object.defineProperty(L,"__esModule",{value:!0});var W=F();L.decode=W.default;L.isBlurhashValid=W.isBlurhashValid;var dr=H();L.encode=dr.default;ur(C())});const $=rr(N()),vr=document.createElement("canvas"),J=(r,e=32,a=32)=>{var t=vr;t.width=e,t.height=a;const s=t.getContext("2d"),i=$.decode(r,e,a,1),d=s.createImageData(e,a);if(d.data.set(i),s.putImageData(d,0,0),t.toDataURL())return t.toDataURL()};(function(r){var e=app.galleryURL,a=app.imgURL,t=app.storageAccessControlAllowOrigin,s=[],i=null;function d(o,n=1e3){if(o.getAttribute("data-loaded"))return;var l=new Image,u=o.getAttribute("data-src");l.onload=()=>{o.setAttribute("data-loaded",!0);var g=()=>{o.parentElement.appendChild(l),setTimeout(()=>{o.onload=()=>{o.parentElement.removeChild(l)},o.src=u,s.length===0&&(clearInterval(i),i=null)},n)};s.push(g),i||(i=setInterval(()=>{if(s.length===0)return;s.pop().apply()},500))},l.src=u}function f(){const o=new IntersectionObserver((l,u)=>{for(entry of l)entry.isIntersecting&&!entry.target.getAttribute("data-loaded")&&entry.target.getAttribute("data-src")&&d(entry.target)},{threshold:.1}),n=document.querySelectorAll("img","#gallery");for(target of n)o.observe(target)}function v(o,n,l,u,g){var h=document.getElementById("gallery"),c=document.createElement("div");c.className="row";for(var b=0,w=o.length,m="",_="";b<w;){m=o[b],_=l[m];var p=document.createElement("a");p.href=n+m,p.setAttribute("data-fslightbox","gallery"),p.className="col-xs-12 col-sm-6 col-md-4 col-lg-3";var M=document.createElement("img");M.src=J(_,u,g),M.setAttribute("data-src",n+m),M.alt=m,p.appendChild(M),c.appendChild(p),b++}h.appendChild(c),f(),refreshFsLightbox()}fetch(`${e}`,{headers:{Accept:"application/json","Access-Control-Allow-Origin":t}}).then(function(o){if(o.status!==200){console.warn("Oops there was a problem. Status Code: "+o.status);return}o.json().then(function(n){v(n.images,a,n.hashmap,24,32)})}).catch(function(o){console.error("Fetch Error: ",o)})})("x");})();
